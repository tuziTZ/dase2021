### 操作系统 第五章 文件系统

7.考虑图5.7中的目录树，如果当前工作目录是/usr/jim，那么相对路径名为../ast/x的文件绝对路径为什么？

..指的是当前目录的父目录，因此绝对路径为：/usr/ast/x

15.空闲磁盘空间可以用空闲链表或位图来管理。假设磁盘地址需要D位，某个磁盘有B个块，其中F个空闲。请问在什么条件下，使用空闲链表所占用的空间要少于位图？如果D为16，请用空闲磁盘空间的百分比来表示你的答案。

位图需要B位来存储，空闲链表需要DF位来存储。如果要使DF<B，而空闲磁盘百分比可以表示为F/B，因为D=16，所以空闲磁盘百分比必须要小于1/16（6.25%）

17.文件系统的性能取决于高速缓存的命中率（即在高速缓存中找到所需块的概率）。假设从高速缓存中读取数据需要1ms，而从磁盘上读取需要40ms。如果命中率为h，请给出读取数据所需要的平均时间计算公式，并画出h从0-1.0变化时的函数曲线。

需要h\*1+40\*(1-h) ms，函数曲线是一条直线。

![image-20230622203534946](C:\Users\tuzi\AppData\Roaming\Typora\typora-user-images\image-20230622203534946.png)

18.硬链接和符号链接之间的区别是什么？每种方案各有什么优点？

硬链接是在目录中添加一个目录项，以不同的文件名称指向同一个文件的i-node。每添加一个硬链接，i-node的链接数就+1。符号链接是一个包含了文件路径的小文件，每次访问的时候通过这个路径查找到对应的目录位置，再去读取原文件的i-node。

硬链接比符号链接高效。符号链接可以克服硬链接不能跨越文件卷的限制。

20.一个磁盘有4000个柱面，每个柱面有8个磁道，每个磁道有512个块。在寻道时每移过一个柱面需要1ms。如果不采取措施使文件的数据块在磁盘上尽量紧靠，那么逻辑上相邻的两个块所需要的平均寻道时间为5ms。另一种情况是操作系统将相邻的块尽量放在一起，此时块间的平均距离为2个柱面，而寻道时间缩减为100$\mu$s。假设旋转延迟为10ms，传输速率为每块20$\mu$s。请问，在这两种情况下，读取一个100块的文件各需要多长时间？

1. 5ms\*100+100\*20$\mu$s+100\*100$\mu$s*0.5(旋转时间平均旋转一半)=1002ms
2. 100$\mu$s\*100+100\*20$\mu$s+100\*100$\mu$s*0.5(旋转时间平均旋转一半)=512ms

27.当一个文件被删除时，它的块通常会返回到空闲链表中，但不会被清除。你认为操作系统是否应该在释放一个块之前把它清除？请从安全和性能两个方面来考虑，并解释各自的影响。

从安全角度看，应当清除，因为用户使用过的块可能写入了用户的重要信息，如果不加以清除可能会被读取。

从性能角度看，这会产生大量额外的磁盘写入，会降低性能。

因此可以只清除较为关键的文件。