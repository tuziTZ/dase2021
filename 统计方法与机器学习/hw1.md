## Due Day：Oct. 4

## Q1

考虑一个因子有4种不同的水平，在各个水平下，我们进行了6次重复实验。已计算SST=10，SSE=2.5，请写出完整的ANOVA表。

方差分析表：

| 来源  | 平方和SS | 自由度df | 均方和MS | F值  |
| ----- | -------- | -------- | -------- | ---- |
| 因子A | 7.5      | 3        | 2.5      | 20   |
| 误差E | 2.5      | 20       | 0.125    |      |
| 总和  | 10       | 23       |          |      |



## Q2

假设我们有两组独立的数据

第一组:  x1,x2,⋯,xm

第二组: y1,y2,⋯,ym

假定xi∼i.i.dN(μ1,σ2)且yi∼i.i.dN(μ2,σ2)。其中，σ2是未知常数。检验问题为

H0:μ1=μ2 vs H0:μ1≠μ2.

- 用单因子方差分析模型来解决这个假设检验问题；
   \- 证明：在这种情况下，单因子方差分析模型与二样本独立t检验是等价的。（提示：考虑两个**检验统计量分布**之间的关系）

证明：

**单因子方差分析**：

组间偏差平方和$SS_A=m[(\overline{x}-\frac{\overline{x}+\overline{y}}{2})^2+(\overline{y}-\frac{\overline{x}+\overline{y}}{2})^2]=\frac{m(\overline{x}-\overline{y})^2}{2}$

组内偏差平方和$SS_E=\sum{(x_i-\overline{x})^2}+\sum{(y_i-\overline{y})^2}$

检验统计量$F_A=\frac{\frac{m(\overline{x}-\overline{y})^2}{2}\times (2m-2)}{\sum{(x_i-\overline{x})^2}+\sum{(y_i-\overline{y})^2}}=\frac{m(m-1)(\overline{x}-\overline{y})^2}{s^2_1+s^2_2}$

其中$F_A$应当服从$F(a-1,n-a)=F(1,2m-2)$

**二样本独立t检验**：

检验统计量：$t=\frac{\overline{x}-\overline{y}}{\sqrt{\frac{1}{m}(s^2_1+s^2_2)}}$

其中t应当服从$t(2m-2)$

由以上分析可知：$F_A=(m-1)t^2$

因此这两个检验统计量等价，检验结果一致。



## Q3

假设我们有数据如下

第1组：y11 , y12 , ⋯⋯ , y1m1
 第2组：y21​ , y22 , ⋯⋯ , y2m2
 ⋮⋮
 第a组：ya1​ , ya2​ , ⋯⋯ , yama
 注：这组数据中每组的重复次数是不相等的。

- 写出符合此数据的单因子方差分析模型；

  均值模型$y_{ij}=\mu_i+\epsilon_{ij}$

- 写出原假设与备择假设；

  $H_0:$$\mu_1=\mu_2=...=\mu_a$

  $H_1:$存在在两种水平i,j下的均值不相等，即$\mu_i \ne\mu_j$

- 写出检验统计量；

  因为每组的m值不同，因此组间和组内偏差平方和的表示方式都有所不同：
  $$
  SS_A = \sum_{i=1}^{a} m_i (\bar{y}_{i.} - \bar{y_{..}})^2
  $$
  
  $$
  SS_E = \sum_{i=1}^{a} \sum_{j=1}^{m_i} (y_{ij} - \bar{y}_{i.})^2
  $$
  检验统计量：
  $$
  F_A = \frac{SS_A/(a-1)}{SS_E/(n-a)}
  $$
  其中，$n=\sum m_i$

- 写出方差分析表。

  | 来源  | 平方和SS | 自由度df | 均方和MS           | F值                                   |
  | ----- | -------- | -------- | ------------------ | ------------------------------------- |
  | 因子A | $SS_A$   | a-1      | $\frac{SS_A}{a-1}$ | $F_A = \frac{SS_A/(a-1)}{SS_E/(n-a)}$ |
  | 误差E | $SS_E$   | n-a      | $\frac{SS_E}{n-a}$ |                                       |
  | 总和  | $SS_T$   | n-1      |                    |                                       |

  

## Q4

有七种人造纤维，每种抽4根测其强度，得每种纤维的平均强度及标准差如下：
 组号  均值   标准差
 1    6.3   0.81
 2    6.2   0.92
 3    6.7   1.22
 4    6.8   0.74
 5    6.5   0.88
 6    7.0   0.58
 7    7.1   1.05
 假设各种纤维的强度服从等方差的正态分布。

- 试问七种纤维强度见有无显著差异（取α=0.05）？
- 根据第一小问的结果，回答：
  - 若各种纤维之间的强度间无显著差异，则给出平均强度的置信水平为0.95的置信区间。
  - 若各种纤维的强度间有显著差异，请进一步在α=0.05下进行多重比较，并指出哪种纤维平均强度最大，同时给出该种纤维平均强度的置信水平为0.95的置信区间。

1. 假设检验：

   H0: $\mu_1=\mu_2=...=\mu_7$

   H1: 其中有至少两者均值不等

   已知a=7, m=4

   SSA的计算方法是求出每组的均值与总均值的差，再相加

   SSA=4x(0.36^2^+0.46^2^+0.04^2^+0.14^2^+0.16^2^+0.34^2^+0.44^2^)=2.7886

   SSE的计算方法是将所有方差相加

   SSE=5.7518

   $F_A$=1.6969

   F(a-1, n-a)=F(6, 21)

   查表得$F_{1-\alpha}(6, 21)$=2.57

   因此这七种纤维强度没有显著差异。

2. 总体均值的置信区间公式是：
   $$
   [\overline{\mu} -t_{1-\alpha/2}\sqrt{\frac{SSE}{n-a}},\overline{\mu} +t_{1-\alpha/2}\sqrt{\frac{SSE}{n-a}}]
   $$
   $\mu$=6.657
   
   t(n-a)=2.080
   
   因此结果为[5.569, 7.745]
